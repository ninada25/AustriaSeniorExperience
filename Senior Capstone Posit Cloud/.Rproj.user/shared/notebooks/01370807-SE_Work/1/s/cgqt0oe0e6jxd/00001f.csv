"0","# Using DALEX package to implement permutation importance in R"
"0",""
"0","library(DALEX)"
"0","library(randomForest)"
"0",""
"0","set.seed(123)"
"0","PI_model <- randomForest(Happiness_score ~ ., data = countries_with_happy_imputed)"
"0",""
"0","# Create an explainer object"
"0","explainer <- explain(PI_model, data = countries_with_happy_imputed[,-which(names(countries_with_happy_imputed) == ""Happiness_score"")], y = countries_with_happy_imputed$Happiness_score)"
"1","Preparation of a new explainer is initiated
"
"1","  -> model label       : "
"1"," "
"1","randomForest"
"1"," "
"1"," ("
"1"," "
"1","[33m"
"1"," "
"1","default"
"1"," "
"1","[39m"
"1"," "
"1",")
"
"1","  -> data              : "
"1"," "
"1","137"
"1"," "
"1"," rows "
"1"," "
"1","6"
"1"," "
"1"," cols 
"
"1","  -> target variable   : "
"1"," "
"1","137"
"1"," "
"1"," values 
"
"1","  -> predict function  : "
"1"," "
"1","yhat.randomForest"
"1"," "
"1"," will be used ("
"1"," "
"1","[33m"
"1"," "
"1","default"
"1"," "
"1","[39m"
"1"," "
"1",")
"
"1","  -> predicted values  :  No value for predict function target column."
"1"," "
"1","("
"1"," "
"1","[33m"
"1"," "
"1","default"
"1"," "
"1","[39m"
"1"," "
"1",")
"
"1","  -> model_info        :  package"
"1"," "
"1","randomForest"
"1"," "
"1",", ver."
"1"," "
"1","4.7.1.1"
"1"," "
"1",", task"
"1"," "
"1","regression"
"1"," "
"1","("
"1"," "
"1","[33m"
"1"," "
"1","default"
"1"," "
"1","[39m"
"1"," "
"1",")"
"1"," "
"1","
"
"1","  -> predicted values  :  numerical, min = "
"1"," "
"1","3.35"
"1"," "
"1",", mean = "
"1"," "
"1","5.42"
"1"," "
"1",", max = "
"1"," "
"1","7.44"
"1"," "
"1"," 
"
"1","  -> residual function :  difference between y and yhat ("
"1"," "
"1","[33m"
"1"," "
"1","default"
"1"," "
"1","[39m"
"1"," "
"1",")
"
"1","  -> residuals         :  numerical, min = "
"1"," "
"1","-0.578"
"1"," "
"1",", mean = "
"1"," "
"1","0.00628"
"1"," "
"1",", max = "
"1"," "
"1","0.667"
"1"," "
"1"," 
"
"1",""
"1"," "
"1","[32m"
"1"," "
"1","A new explainer has been created!"
"1"," "
"1","[39m"
"1"," "
"1","
"
"0","# Calculate Permutation Importance"
"0","perm_importance <- feature_importance(explainer, loss_function = DALEX::loss_root_mean_square, type = ""variable_importance"")"
"0",""
"0","# Print the results"
"0","print(perm_importance)"
"1"," "
"1","     variable"
"1"," mean_dropout_loss"
"1","        label"
"1","
1"
"1"," _full_model_"
"1","             0.238"
"1"," randomForest"
"1","
2"
"1","     Military"
"1","             0.308"
"1"," randomForest"
"1","
3"
"1"," Unemployment"
"1","             0.326"
"1"," randomForest"
"1","
4"
"1","       Health"
"1","             0.382"
"1"," randomForest"
"1","
5"
"1","       Region"
"1","             0.548"
"1"," randomForest"
"1","
6"
"1","     Internet"
"1","             0.557"
"1"," randomForest"
"1","
7"
"1","          GDP"
"1","             0.670"
"1"," randomForest"
"1","
8"
"1","   _baseline_"
"1","             1.497"
"1"," randomForest"
"1","
"
"0","# Plot the permutation importance"
"0","plot(perm_importance)"
